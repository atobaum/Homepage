function resetBook(){$("#form_isbn13").val(""),$("#form_book").val(""),$("#book_panel").hide(),$(".ui.search").show()}function selectBook(o){console.log("tes"),$.ajax({url:"/bookshelf/api/bookinfo/aladin?isbn13="+o,dataType:"json",success:function(o){if(0===o.ok)return void console.log("error");var e=o.result,t="";for(var r in e.authors){var a=e.authors[r];switch(t+=a.name,a.type){case"author":t+=" 지음, ";break;case"translator":t+=" 번역, ";break;case"supervisor":t+=" 감수, ";break;case"illustrator":t+=" 그림, "}}t=t.substring(0,t.length-2)+".",console.log(t),$("#form_isbn13").val(e.isbn13),$("#book_cover").attr("src",e.cover_URL),$("#book_title").text(e.title),$("#book_authors").text(t),$("#book_publish").text(e.publisher+" | "+e.published_date),$(".ui.search").search("set value",""),$("#book_list_wrapper").hide(),$("#book_panel").show(),$(".ui.search").hide(),$("#form_book").val(JSON.stringify(e))}})}function hoverBook(o){$("#book_info img").attr("src",this.getAttribute("cover_url")),$("#book_info strong").text(this.getAttribute("title")),$("#book_info img").attr("src",this.getAttribute("cover_url")),$("#book_info li:nth-child(1)").text(this.getAttribute("author")),$("#book_info li:nth-child(2)").text(this.getAttribute("publisher")+" | "+this.getAttribute("published_date"))}function searchBookByKeyword(o,e){$.ajax({url:"/bookshelf/api/searchbook?keyword="+o,dataType:"json",success:function(o){var e=$("#book_list");e.empty(),$.each(o,function(o,t){e.append($("<li />",{id:"book_"+o,text:t.title,class:"book"})),$("#book_"+o).attr(t).click(selectBook).hover(hoverBook)}),$("#book_list_wrapper").show()}})}function check_form(){$("form .field").removeClass("error"),$("form .ui.message").hide();var o=!0,e="";return 0===$("#form_book").val().length&&(e+="책을 선택하세요. ",o=!1),0===$("#form_date_started").val().length&&($("#form_date_started").parent().addClass("error"),e+="책을 읽기 시작한 날짜를 선택하세요. ",o=!1),0===$("#form_user").val().length&&($("#form_user").parent().addClass("error"),e+="당신은 누구인가요?",o=!1),o||($(".ui.message .header").text("어딘가 비어있는 폼."),$(".ui.message p").text(e),$("form .ui.message").addClass("error"),$("form .ui.message").show()),o}function DelayedHandler(){this.timer=null,this.handler="",this.millisec="",this.start=function(o,e){this.timer&&clearInterval(this.timer),this.timer=setTimeout(o,e)}}var selectedBook;$(document).ready(function(){$("#book_panel").hide(),$("#book_search").keyup(function(){var o=$("#book_search").val();0===o.length?($("#book_list_wrapper").hide(),$("#book_search_bar").removeClass("loading")):($("#book_search_bar").addClass("loading"),delayedHnadlerForTitle.start(function(){searchBookByKeyword(o),$("#book_search_bar").removeClass("loading")},1500))}),$("#book_search").focus(function(){0!==$("#book_search").val().length&&$("#book_list_wrapper").show()}),$(".ui.search").search({apiSettings:{url:"/bookshelf/api/searchbook?keyword={query}"},searchDelay:1e3,onSelect:function(o,e){selectBook(o.isbn13)},onResults:function(o){console.log(o)}}),$(".rating").starRating({starShape:"rounded",starSize:25,disableAfterRate:!1}),$("#mod_btn").click(function(){$("form *").removeAttr("readonly"),$(".rating").starRating("setReadOnly",!1),$(".ui.buttons").show(),$(this).hide()}),$("#ok_btn").click(function(){check_form()&&($("#form_rating").val(2*$(".rating").starRating("getRating")),$('form input[type="checkbox"]').prop("checked")?$('form input[name="is_secret"]').val(1):$('form input[name="is_secret"]').val(0),$("#input_form").submit())}),$("#can_btn").click(function(){$(".rating").starRating("setRating",parseInt($("#form_rating").val())/2),resetBook()}),$("#change_book").click(function(){resetBook()})});