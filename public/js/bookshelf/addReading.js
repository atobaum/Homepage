function resetBook(){$("#form_isbn13").val(""),$("#form_book").val(""),$("#book_panel").hide(),$(".ui.search").show()}function selectBook(e){console.log("tes"),$.ajax({url:"/bookshelf/api/bookinfo/aladin?isbn13="+e,dataType:"json",success:function(e){if(0===e.ok)return void console.log("error");var o=e.result,r="";for(var t in o.authors){var a=o.authors[t];switch(r+=a.name,a.type){case"author":r+=" 지음, ";break;case"translator":r+=" 번역, ";break;case"supervisor":r+=" 감수, ";break;case"illustrator":r+=" 그림, "}}r=r.substring(0,r.length-2)+".",console.log(r),$("#form_isbn13").val(o.isbn13),$("#book_cover").attr("src",o.cover_URL),$("#book_title").text(o.title),$("#book_authors").text(r),$("#book_publish").text(o.publisher+" | "+o.published_date),$(".ui.search").search("set value",""),$("#book_list_wrapper").hide(),$("#book_panel").show(),$(".ui.search").hide(),$("#form_book").val(JSON.stringify(o))}})}function searchBookByKeyword(e,o){$.ajax({url:"/bookshelf/api/searchbook?keyword="+e,dataType:"json",success:function(e){var o=$("#book_list");o.empty(),$.each(e,function(e,r){o.append($("<li />",{id:"book_"+e,text:r.title,class:"book"})),$("#book_"+e).attr(r).click(selectBook).hover(hoverBook)}),$("#book_list_wrapper").show()}})}function check_form(){$("form .field").removeClass("error"),$("form .ui.message").hide();var e=!0,o="";return 0===$("#form_book").val().length&&(o+="책을 선택하세요. ",e=!1),0===$("#form_date_started").val().length&&($("#form_date_started").parent().addClass("error"),o+="책을 읽기 시작한 날짜를 선택하세요. ",e=!1),0===$("#form_user").val().length&&($("#form_user").parent().addClass("error"),o+="당신은 누구인가요?",e=!1),e||($(".ui.message .header").text("어딘가 비어있는 폼."),$(".ui.message p").text(o),$("form .ui.message").addClass("error"),$("form .ui.message").show()),e}function DelayedHandler(){this.timer=null,this.handler="",this.millisec="",this.start=function(e,o){this.timer&&clearInterval(this.timer),this.timer=setTimeout(e,o)}}var selectedBook;$(document).ready(function(){$("#book_panel").hide(),$("#book_search").keyup(function(){var e=$("#book_search").val();0===e.length?($("#book_list_wrapper").hide(),$("#book_search_bar").removeClass("loading")):($("#book_search_bar").addClass("loading"),delayedHnadlerForTitle.start(function(){searchBookByKeyword(e),$("#book_search_bar").removeClass("loading")},1500))}),$("#book_search").focus(function(){0!==$("#book_search").val().length&&$("#book_list_wrapper").show()}),$(".ui.search").search({apiSettings:{url:"/bookshelf/api/searchbook?keyword={query}"},searchDelay:1e3,onSelect:function(e,o){selectBook(e.isbn13)},onResults:function(e){console.log(e)}}),$(".rating").starRating({starShape:"rounded",starSize:25,disableAfterRate:!1}),$("#mod_btn").click(function(){$("form *").removeAttr("readonly"),$(".rating").starRating("setReadOnly",!1),$(".ui.buttons").show(),$(this).hide()}),$("#ok_btn").click(function(){check_form()&&($("#form_rating").val(2*$(".rating").starRating("getRating")),$('form input[type="checkbox"]').prop("checked")?$('form input[name="is_secret"]').val(1):$('form input[name="is_secret"]').val(0),$("#input_form").submit())}),$("#can_btn").click(function(){$(".rating").starRating("setRating",parseInt($("#form_rating").val())/2),resetBook()}),$("#change_book").click(function(){resetBook()})});